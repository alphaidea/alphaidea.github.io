<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>优雅地提交 Git Commit Message | 文詣不文藝</title>
<meta name="description" content="從來如此，便对吗？" />
<link rel="shortcut icon" href="https://alphaidea.github.io/favicon.ico?v=1602739073254">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://alphaidea.github.io/styles/main.css">

<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-168041747-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-168041747-1');
</script>


  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://alphaidea.github.io">
  <img class="avatar" src="https://alphaidea.github.io/images/avatar.png?v=1602739073254" alt="">
  </a>
  <h1 class="site-title">
    文詣不文藝
  </h1>
  <p class="site-description">
    從來如此，便对吗？
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          首頁
        </a>
      
    
      
        <a href="/archives" class="menu">
          歸檔
        </a>
      
    
      
        <a href="/tags" class="menu">
          標籤
        </a>
      
    
      
        <a href="/post/friends" class="menu">
          朋友們
        </a>
      
    
      
        <a href="/post/about" class="menu">
          關於
        </a>
      
    
  </div>
  <div class="social-container">
    
      
        <a href="https://github.com/AlphaIdea" target="_blank">
          <i class="fab fa-github"></i>
        </a>
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              优雅地提交 Git Commit Message
            </h2>
            <div class="post-info">
              <span>
                2019-12-12
              </span>
              <span>
                4 min read
              </span>
              
                <a href="https://alphaidea.github.io/tag/kbr3QMZde/" class="post-tag">
                  # Git
                </a>
              
            </div>
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <h2 id="why">Why</h2>
<p>如果在版本回退的时候看到一大段完全不知所云的 Commit，大概会是一种非常糟心的体验。而规范的提交后，只需要看标识符就可以明白提交的目的。</p>
<h3 id="方便浏览">方便浏览</h3>
<p>提供更多的信息，方便排查与回退</p>
<pre><code class="language-bash">git log HEAD --pretty=format:%s
</code></pre>
<h3 id="便于查找">便于查找</h3>
<p>过滤关键字，迅速定位</p>
<pre><code class="language-bash"># 查找新增功能
git log HEAD --grep feat
</code></pre>
<h2 id="git-commit-规范">Git Commit 规范</h2>
<pre><code class="language-git">&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;
&lt;BLANK LINE&gt;
&lt;body&gt;
&lt;BLANK LINE&gt;
&lt;footer&gt;
</code></pre>
<h3 id="header">Header</h3>
<p>Header 仅有一行，包含三个字段</p>
<ul>
<li>type（必需）：用于说明 commit 的类别</li>
<li>scope（可选）：用于说明 commit 影响的范围，比如数据层、控制层、视图层等，视项目不同而不同</li>
<li>subject（必需）：commit 目的的简短描述
<ul>
<li>首字母不大写</li>
<li>末尾不要标点</li>
<li>以动词开头，使用第一人称现在时，比如 change，而不是 changed 或 changes</li>
</ul>
</li>
</ul>
<h4 id="type-只允许使用下面-7-个标识">type 只允许使用下面 7 个标识</h4>
<ul>
<li>feat：新功能（feature）</li>
<li>fix：修复 bug</li>
<li>docs：文档（documentation）</li>
<li>style： 格式（不影响代码逻辑）</li>
<li>refactor：重构（既不是新增功能，也不是修改 bug 的- 代码变动）</li>
<li>test：增加测试（单元测试、集成测试）</li>
<li>chore：构建过程或辅助工具的变动</li>
<li><a href="#%E7%89%B9%E6%AE%8A%E6%83%85%E5%86%B5-revert"><em><strong>revert：回滚到某一个版本</strong></em></a></li>
</ul>
<h3 id="body">Body</h3>
<p>Body 是对本次 commit 的详细描述，可分成多行。应说明代码变动的动机，以及与以前功能的对比。</p>
<h3 id="footer">Footer</h3>
<p>该部分用于两种情况：</p>
<ul>
<li>不兼容的变动：与上一个版本不兼容，则 Footer 部分以 BREAKING CHANGE 开头</li>
<li>关闭 Issue：commit 针对某个 issue，在 Footer 中可以写上 Closes #123</li>
</ul>
<h3 id="特殊情况-revert">特殊情况 Revert</h3>
<p>有一种特殊情况，如果当前 commit 用于撤销以前的 commit：</p>
<p>必须以 revert: 开头，后面跟着被撤销 commit 的 Header<br>
Body 部分的格式是固定的，必须写成 This reverts commit &lt;hash&gt;.<br>
hash 为被撤销 commit 的 SHA 标识符</p>
<h3 id="好的格式">好的格式</h3>
<blockquote>
<p>50-character subject line</p>
<p>72-character wrapped longer description. This should answer:</p>
<ul>
<li>Why was this change necessary?</li>
<li>How does it address the problem?</li>
<li>Are there any side effects?</li>
</ul>
<p>Include a link to the ticket, if any.</p>
<p>Add co-authors if you worked on this code with others:</p>
<p>Co-authored-by: Full Name <a href="mailto:email@example.com">email@example.com</a><br>
Co-authored-by: Full Name <a href="mailto:email@example.com">email@example.com</a></p>
</blockquote>
<h2 id="git-分支与版本发布规范">Git 分支与版本发布规范</h2>
<h3 id="基本原则">基本原则</h3>
<p>master 为保护分支，不直接在 master 上进行代码修改和提交。</p>
<h3 id="日常开发">日常开发</h3>
<p>从 master 分支上 checkout 一个 feature 分支进行开发或者 bugfix 分支进行 bug 修复，功能测试完毕并且项目发布上线后，将 feature 分支合并到主干 master，并且打 Tag 发布，最后删除开发分支。</p>
<h3 id="分支命名规范">分支命名规范</h3>
<p>分支类型_分支发布时间_分支功能。<br>
比如：feature_20191221_git_commit</p>
<p>分支类型包括 feature、bugfix、refactor 三种类型，<br>
时间使用年月日进行命名，不足 2 位补 0。<br>
分支功能命名使用 snake case 命名法。</p>
<h3 id="tag">Tag</h3>
<p>Tag 包括 3 位版本，前缀使用 v，比如 v0.1.13</p>
<h4 id="tag-命名规范">Tag 命名规范</h4>
<p>新功能开发使用第 2 位版本号，bug 修复使用第 3 位版本号</p>
<p>核心基础库可以在大版本发布前使用灰度版本号，即在版本后面加上后缀，用中划线分隔。alpha 或者 beta 后面加上次数，即第几次 alpha：</p>
<p>v2.0.0-alpha.1</p>
<p>v2.0.0-beta.2</p>
<p>版本正式发布前需要生成 changelog 文档，然后再发布上线。</p>
<hr>
<p><em>规范没有绝对的好坏，只要适合团队和个人就行</em></p>
<p><em>好的习惯尽早养成，受益终身</em></p>
<h2 id="reference">Reference</h2>
<p><a href="https://github.com/angular/angular.js/blob/master/DEVELOPERS.md#commits" title="angular">AngularJS Commits</a></p>
<p><a href="https://www.conventionalcommits.org" title="Conventional Commits">Conventional Commits</a></p>
<p><a href="https://tbaggery.com/2008/04/19/a-note-about-git-commit-messages.html" title="Tim Pope">A Note About Git Commit Messages</a></p>
<p><a href="http://www.ruanyifeng.com/blog/2016/01/commit_message_change_log.html" title="阮一峰老师">Commit message 和 Change log 编写指南</a></p>
<p><a href="https://thoughtbot.com/blog/5-useful-tips-for-a-better-commit-message" title="thoughtbot">5 Useful Tips For A Better Commit Message</a></p>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#why">Why</a>
<ul>
<li><a href="#%E6%96%B9%E4%BE%BF%E6%B5%8F%E8%A7%88">方便浏览</a></li>
<li><a href="#%E4%BE%BF%E4%BA%8E%E6%9F%A5%E6%89%BE">便于查找</a></li>
</ul>
</li>
<li><a href="#git-commit-%E8%A7%84%E8%8C%83">Git Commit 规范</a>
<ul>
<li><a href="#header">Header</a>
<ul>
<li><a href="#type-%E5%8F%AA%E5%85%81%E8%AE%B8%E4%BD%BF%E7%94%A8%E4%B8%8B%E9%9D%A2-7-%E4%B8%AA%E6%A0%87%E8%AF%86">type 只允许使用下面 7 个标识</a></li>
</ul>
</li>
<li><a href="#body">Body</a></li>
<li><a href="#footer">Footer</a></li>
<li><a href="#%E7%89%B9%E6%AE%8A%E6%83%85%E5%86%B5-revert">特殊情况 Revert</a></li>
<li><a href="#%E5%A5%BD%E7%9A%84%E6%A0%BC%E5%BC%8F">好的格式</a></li>
</ul>
</li>
<li><a href="#git-%E5%88%86%E6%94%AF%E4%B8%8E%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83%E8%A7%84%E8%8C%83">Git 分支与版本发布规范</a>
<ul>
<li><a href="#%E5%9F%BA%E6%9C%AC%E5%8E%9F%E5%88%99">基本原则</a></li>
<li><a href="#%E6%97%A5%E5%B8%B8%E5%BC%80%E5%8F%91">日常开发</a></li>
<li><a href="#%E5%88%86%E6%94%AF%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83">分支命名规范</a></li>
<li><a href="#tag">Tag</a>
<ul>
<li><a href="#tag-%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83">Tag 命名规范</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">下一篇</div>
            <a href="https://alphaidea.github.io/post/javascript-shu-zi-qu-zheng/">
              <h3 class="post-title">
                JavaScript 数字取整
              </h3>
            </a>
          </div>
        

        
          
            <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>

  var gitalk = new Gitalk({
    clientID: '88c6442ae471aee209aa',
    clientSecret: '900f673cb67dbdcfe3aa388d84e0df4387b3b8e8',
    repo: 'alphaidea.github.io',
    owner: 'Alphaidea',
    admin: ['Alphaidea'],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')

</script>

          

          
        

        <div class="site-footer">
  自由而不獨立，仍是奴隸 | 
  <a class="rss" href="https://alphaidea.github.io/atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()

  let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

  // This should probably be throttled.
  // Especially because it triggers during smooth scrolling.
  // https://lodash.com/docs/4.17.10#throttle
  // You could do like...
  // window.addEventListener("scroll", () => {
  //    _.throttle(doThatStuff, 100);
  // });
  // Only not doing it here to keep this Pen dependency-free.

  window.addEventListener("scroll", event => {
    let fromTop = window.scrollY;

    mainNavLinks.forEach((link, index) => {
      let section = document.getElementById(decodeURI(link.hash).substring(1));
      let nextSection = null
      if (mainNavLinks[index + 1]) {
        nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
      }
      if (section.offsetTop <= fromTop) {
        if (nextSection) {
          if (nextSection.offsetTop > fromTop) {
            link.classList.add("current");
          } else {
            link.classList.remove("current");    
          }
        } else {
          link.classList.add("current");
        }
      } else {
        link.classList.remove("current");
      }
    });
  });

</script>

      </div>
    </div>
  </body>
</html>
